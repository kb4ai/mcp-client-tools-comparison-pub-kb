# YAML Schema Specification for MCP Ecosystem Tool Analysis
# All fields except those marked as REQUIRED are optional
# last-update and repo-url are REQUIRED fields

schema_version: "1.1"

fields:
  # === TRACKING FIELDS (first fields in every project YAML) ===
  last-update:
    type: string
    format: "YYYY-MM-DD"
    required: true
    description: "Date when this YAML was last updated"

  repo-commit:
    type: string
    description: "Git commit hash that analysis was based on"

  repo-url:
    type: string
    format: url
    required: true
    description: "Full GitHub/GitLab URL"

  # === BASIC INFO ===
  name:
    type: string
    description: "Project name (defaults to repo name if not specified)"

  description:
    type: string
    description: "Brief description of what the tool does"

  language:
    type: string
    description: "Primary programming language"

  languages:
    type: array
    items: string
    description: "All languages used (from GitHub)"

  license:
    type: string
    description: "License type (MIT, Apache-2.0, etc.)"

  # === REPUTATION/TRUST METRICS ===
  stars:
    type: integer
    description: "GitHub stars count (at time of last-update)"

  forks:
    type: integer
    description: "GitHub forks count"

  watchers:
    type: integer
    description: "GitHub watchers count"

  contributors:
    type: integer
    description: "Number of contributors"

  open-issues:
    type: integer
    description: "Number of open issues"

  last-commit:
    type: string
    format: "YYYY-MM-DD"
    description: "Date of most recent commit"

  created:
    type: string
    format: "YYYY-MM-DD"
    description: "Repository creation date"

  reputable-source:
    type: boolean
    description: "From official/known organization (Anthropic, Microsoft, Docker, etc.)"

  organization:
    type: string
    description: "Organization name if from reputable source"

  archived:
    type: boolean
    description: "Is the repository archived?"

  # === CATEGORY & TYPE ===
  category:
    type: string
    enum:
      # --- MCP Clients & CLI Tools ---
      - cli-client              # CLI interfaces for interacting with MCP servers
      - official-tool           # Official Anthropic/MCP tools (Inspector, etc.)

      # --- Transport Bridges ---
      - http-bridge             # stdio ↔ HTTP/SSE conversion
      - websocket-bridge        # stdio ↔ WebSocket
      - grpc-bridge             # MCP ↔ gRPC/protobuf
      - rest-api-bridge         # OpenAI-compatible REST API bridges

      # --- OpenAPI ↔ MCP Conversion ---
      - openapi-to-mcp          # Convert OpenAPI specs → MCP servers (make APIs AI-callable)
      - mcp-to-openapi          # Expose MCP servers as REST/OpenAPI (MCPO, etc.)
      - mcp-framework           # Frameworks for building MCP servers (FastMCP, Spring AI)

      # --- Infrastructure & Enterprise ---
      - proxy-aggregator        # Multi-server proxy/aggregator
      - enterprise-gateway      # Production-ready gateway with security/RBAC
      - cloud-integration       # Cloud platform integrations (Azure APIM, etc.)
      - docker-integration      # Docker-native MCP tools
      - kubernetes-integration  # Kubernetes-native MCP tools

      # --- Other ---
      - specialized-adapter     # CLI wrappers, adapters for specific use cases
    description: "Primary category of the tool"

  secondary-categories:
    type: array
    items: string
    description: "Additional categories if tool fits multiple"

  # === TRANSPORT SUPPORT ===
  transports:
    type: object
    properties:
      stdio:
        type: boolean
        description: "Supports MCP stdio transport"
      sse:
        type: boolean
        description: "Supports Server-Sent Events"
      http:
        type: boolean
        description: "Supports HTTP/Streamable HTTP"
      websocket:
        type: boolean
        description: "Supports WebSocket"
      grpc:
        type: boolean
        description: "Supports gRPC/protobuf"
    description: "Supported MCP transports"

  transport-direction:
    type: string
    enum:
      - stdio-to-http
      - http-to-stdio
      - bidirectional
      - aggregator
      - other
    description: "Primary transport bridging direction"

  # === CONVERSION (for OpenAPI ↔ MCP tools) ===
  conversion-direction:
    type: string
    enum:
      - openapi-to-mcp      # REST API → MCP server
      - mcp-to-openapi      # MCP server → REST API
      - bidirectional       # Both directions
    description: "For conversion tools, which direction they convert"

  input-format:
    type: string
    description: "Input format accepted (e.g., 'OpenAPI 3.0', 'Swagger 2.0', 'MCP stdio')"

  output-format:
    type: string
    description: "Output format produced (e.g., 'MCP server', 'REST API', 'OpenAPI spec')"

  # === CLOUD/PLATFORM ===
  cloud-platform:
    type: string
    enum:
      - azure
      - aws
      - gcp
      - self-hosted
      - any
    description: "Associated cloud platform if applicable"

  # === AUTHENTICATION ===
  # Based on MCP OAuth 2.1 spec (2025-06-18, 2025-11-25) and real-world implementations
  authentication:
    type: object
    properties:
      # --- Supported Auth Methods ---
      oauth2:
        type: boolean
        description: "Supports OAuth 2.0/2.1 flows"
      oauth2-pkce:
        type: boolean
        description: "Supports OAuth 2.1 with PKCE (mandatory per spec)"
      bearer-token:
        type: boolean
        description: "Supports Bearer token auth (Authorization: Bearer)"
      api-key:
        type: boolean
        description: "Supports API key auth (X-API-Key header)"
      basic-auth:
        type: boolean
        description: "Supports HTTP Basic authentication"
      custom-header:
        type: boolean
        description: "Supports custom auth headers"

      # --- OAuth 2.1 Spec Compliance ---
      dynamic-client-registration:
        type: boolean
        description: "Supports Dynamic Client Registration (RFC 7591)"
      cimd:
        type: boolean
        description: "Supports Client ID Metadata Documents (CIMD)"
      resource-indicators:
        type: boolean
        description: "Supports Resource Indicators (RFC 8707) for token audience"
      token-refresh:
        type: boolean
        description: "Supports automatic token refresh"
      step-up-auth:
        type: boolean
        description: "Supports step-up authorization (insufficient_scope handling)"

      # --- Auth Bridging (for gateways/proxies) ---
      auth-bridging:
        type: boolean
        description: "Can bridge auth for backends that don't support OAuth"
      auth-injection:
        type: boolean
        description: "Can inject auth headers for upstream MCP servers"
      token-exchange:
        type: boolean
        description: "Supports OAuth Token Exchange (RFC 8693)"
      vault-integration:
        type: boolean
        description: "Integrates with HashiCorp Vault or similar for credentials"

      # --- Enterprise Auth ---
      entra-id:
        type: boolean
        description: "Supports Microsoft Entra ID (Azure AD)"
      saml:
        type: boolean
        description: "Supports SAML SSO"
      oidc:
        type: boolean
        description: "Supports OpenID Connect"
      rbac:
        type: boolean
        description: "Supports Role-Based Access Control"
      multi-tenant:
        type: boolean
        description: "Supports multi-tenant authentication"

      # --- Environment Variable Auth (STDIO transport) ---
      env-var-auth:
        type: boolean
        description: "Supports auth via environment variables (STDIO pattern)"
      env-var-names:
        type: array
        items: string
        description: "Environment variable names for auth (e.g., GITHUB_TOKEN, API_KEY)"

      # --- Notes ---
      auth-notes:
        type: array
        items: string
        description: "Additional authentication-related notes"
    description: "Supported authentication methods and capabilities"

  # === AUTH TRANSPORT COMPATIBILITY ===
  auth-transports:
    type: object
    properties:
      stdio:
        type: string
        enum: [env-vars, none, n/a]
        description: "Auth method for STDIO transport (env-vars per spec)"
      http:
        type: string
        enum: [oauth2, bearer, api-key, basic, none, n/a]
        description: "Auth method for HTTP transport"
      sse:
        type: string
        enum: [oauth2, bearer, api-key, basic, none, n/a]
        description: "Auth method for SSE transport"
    description: "Authentication methods per transport type"

  # === FEATURES ===
  features:
    type: array
    items: string
    description: "List of notable features"

  # === INSTALLATION ===
  installation:
    type: object
    properties:
      npm:
        type: string
        description: "npm package name"
      pip:
        type: string
        description: "pip/PyPI package name"
      brew:
        type: string
        description: "Homebrew formula/cask"
      docker:
        type: string
        description: "Docker image"
      binary:
        type: boolean
        description: "Provides pre-built binaries"
      go-install:
        type: string
        description: "go install path"
    description: "Installation methods available"

  # === SECURITY ANALYSIS ===
  security:
    type: object
    properties:
      analyzed:
        type: boolean
        description: "Has security analysis been performed?"
      analysis-commit:
        type: string
        description: "Commit hash security analysis was based on"
      eval-usage:
        type: string
        enum: [none, safe, unsafe, needs-review]
        description: "Use of eval/exec type functions"
      subprocess-usage:
        type: string
        enum: [none, sanitized, unsafe, needs-review]
        description: "Use of subprocess/shell commands"
      network-isolation:
        type: string
        enum: [verified, partial, none, needs-review]
        description: "Does it only connect to configured endpoints?"
      input-validation:
        type: string
        enum: [thorough, basic, none, needs-review]
        description: "Input validation/sanitization"
      sandboxing:
        type: boolean
        description: "Supports sandboxing/isolation"
      notes:
        type: array
        items: string
        description: "Security-related notes/concerns"
    description: "Security analysis results"

  # === DOCUMENTATION ===
  documentation:
    type: object
    properties:
      readme:
        type: boolean
        description: "Has README"
      api-docs:
        type: boolean
        description: "Has API documentation"
      examples:
        type: boolean
        description: "Has examples"
      tests:
        type: boolean
        description: "Has tests"
    description: "Documentation quality indicators"

  # === NOTES ===
  notes:
    type: array
    items: string
    description: "General notes about the project"
